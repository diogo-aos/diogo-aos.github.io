<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Diogo Silva">
<meta name="dcterms.date" content="2021-03-27">

<title>Diogo Silva - Lesson 2 -</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Diogo Silva - Lesson 2 -">
<meta property="og:image" content="l2_files/figure-html/cell-2-output-2.png">
<meta property="og:site-name" content="Diogo Silva">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Diogo Silva</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html" rel="" target="">
 <span class="menu-text">blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../research/index.html" rel="" target="">
 <span class="menu-text">research</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/diogo-aos" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://sigmoid.social/@diogo" rel="" target=""><i class="bi bi-mastodon" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lesson 2 -</h1>
  <div class="quarto-categories">
    <div class="quarto-category">estimation-classification-course</div>
    <div class="quarto-category">phd</div>
    <div class="quarto-category">lecture-notes</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Diogo Silva </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 27, 2021</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<ul>
<li>Classic estimation
<ul>
<li>Parabolic fit</li>
<li>Least mean squares</li>
<li>Estimation</li>
<li>Regression</li>
<li>Frequency estimation</li>
<li>Robustness</li>
<li>RANSAC</li>
<li>Exercises &amp; Work</li>
</ul></li>
<li>Classic probabilistic methods
<ul>
<li>classic vs bayesian</li>
<li>Maximum Likelihood</li>
<li>ML vs LS</li>
<li>Crámer-Rao bound</li>
<li>Monte-Carlo</li>
<li>Exercises</li>
</ul></li>
<li>Bibliography
<ul>
<li>Duda, Hart, Stork, Pattern Classification, Wiley, 2001.</li>
<li>J. Marques, Reconhecimento de Padrões. Métodos Estatísticos e Neuronais, IST Press, 1999</li>
</ul></li>
</ul>
</section>
<section id="exercises" class="level1">
<h1>Exercises</h1>
<section id="problem-1---linear-least-squares-predict-signal-at-t" class="level2">
<h2 class="anchored" data-anchor-id="problem-1---linear-least-squares-predict-signal-at-t">Problem 1 - linear least squares, predict signal at t</h2>
<p>Given a signal <span class="math inline">\(y=( y_1 , ..., y_N )\)</span>, determine the coefficients of the linear predictor</p>
<p><span class="math inline">\(y_t = a_1 y_{t-1} + ... a_p y_{t-p}, N&gt;&gt;P\)</span></p>
<p>using the least squares method.</p>
<hr>
<p>Let <span class="math inline">\(\theta = [a_1,..., a_p]^T\)</span> be the parameter set.</p>
<p>Error is given by</p>
<p><span class="math display">\[
E = \sum_{i}{(y_i - x_i \theta )^2}
\]</span></p>
<p>Where, for each <span class="math inline">\(y_i\)</span>, we have <span class="math inline">\(x_i = (y_{i-1}, ..., y_{i-p})\)</span>. This means, using historical data, we can’t use <span class="math inline">\(y_1, ..., y_p\)</span>.</p>
<p>We want to minimize <span class="math inline">\(\theta\)</span> such that <span class="math inline">\(E = 0\)</span>.</p>
<p><span class="math display">\[
\frac{\partial E}{\partial \theta_j} = \frac{\partial \sum_{i}{(y_i - x_i \theta )^2}}{\partial \theta_j} =
2 \sum_{i}{ \frac{\partial(y_i - x_i \theta )}{\partial \theta_j}} =
2 \sum_{i}{ -x_{i_j} \theta_j}
\]</span></p>
<p>We then have</p>
<p><span class="math display">\[
\frac{\partial E}{\partial \theta} =
\begin{bmatrix}
-2 \sum_{i}{x_{i_1} \theta_1} \\
\vdots \\
-2 \sum_{i}{x_{i_p} \theta_p} \\
\end{bmatrix}
= 0
\]</span></p>
<p>Solving this equation will give us the parameter values.</p>
</section>
<section id="problem-2---predict-signal-in-ttk-todo-recheck" class="level2">
<h2 class="anchored" data-anchor-id="problem-2---predict-signal-in-ttk-todo-recheck">Problem 2 - predict signal in [t,t+k] TODO RECHECK</h2>
<p>By increasing the prediction window, we’re increasing the number of parameters. If, for each prediction, we were looking at <span class="math inline">\(p\)</span> previous signals and using <span class="math inline">\(p\)</span> parameters for prediciting the next signal <span class="math inline">\(y_t\)</span>, now we’ll need <span class="math inline">\(k \times p\)</span> parameters for predicting <span class="math inline">\((y_t, ..., y_{t+k})\)</span>. We have</p>
<p><span class="math display">\[
\begin{bmatrix}
x_1 \\
\vdots \\
x_N
\end{bmatrix}
\times
\begin{bmatrix}
a_{1_1}  &amp; ... &amp; a_{k_1} \\
\vdots &amp;  &amp; \vdots \\
a_{1_p}  &amp; ... &amp; a_{k_p} \\
\end{bmatrix} =
\begin{bmatrix}
y_{1_1} &amp; ... &amp; y_{1_k} \\
\vdots &amp;  &amp; \vdots \\
y_{N_1}  &amp; ... &amp; y_{N_k} \\
\end{bmatrix}
\]</span></p>
<p>Since the prediciton at <span class="math inline">\(y_t\)</span> doesn’t affect subsequent predictions and the parameters for <span class="math inline">\(y_t\)</span></p>
<p><span class="math display">\[
\frac{\partial E}{\partial \theta} =
\begin{bmatrix}
-2 \sum_{i}{x_{i_1} \theta_{1_1}} &amp; ... &amp; -2 \sum_{i}{x_{i_1} \theta_{k_1}}\\
\vdots &amp; &amp; \vdots \\
-2 \sum_{i}{x_{i_p} \theta_{1_p}} &amp; ... &amp; -2 \sum_{i}{x_{i_p} \theta_{k_p}}
\end{bmatrix}
= 0
\]</span></p>
<hr>
</section>
</section>
<section id="least-squares-demo" class="level1">
<h1>Least squares demo</h1>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>dim <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>interval <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">200</span>]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>outlier_fraction <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">## create dataset</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.randint(interval[<span class="dv">0</span>], interval[<span class="dv">1</span>], (N, <span class="dv">2</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>gt <span class="op">=</span> x[:,<span class="dv">0</span>] <span class="op">*</span> params[<span class="dv">0</span>] <span class="op">+</span> x[:,<span class="dv">1</span>] <span class="op">*</span> params[<span class="dv">1</span>]</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># add random noise</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> gt <span class="op">+</span> np.random.random(gt.shape)<span class="op">*</span><span class="fl">0.1</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># add outliers with 1000*N(0,1)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> np.random.randint(<span class="dv">0</span>, N, <span class="bu">int</span>(outlier_fraction <span class="op">*</span> N))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>y[idx] <span class="op">=</span> y[idx] <span class="op">+</span> np.random.rand(idx.size)<span class="op">*</span><span class="dv">1000</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>xx, yy <span class="op">=</span> np.meshgrid(<span class="bu">range</span>(interval[<span class="dv">1</span>]), <span class="bu">range</span>(interval[<span class="dv">1</span>]))</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>z_plane <span class="op">=</span> xx<span class="op">*</span>params[<span class="dv">0</span>] <span class="op">+</span> yy<span class="op">*</span>params[<span class="dv">1</span>]</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create figure</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3D plane</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>ax.plot_surface(xx, yy, z_plane, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Set labels</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'x1'</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'x2'</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">'y'</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co">#and i would like to plot this point : </span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>ax.scatter(x[:,<span class="dv">0</span>], x[:,<span class="dv">1</span>], gt, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>ax.scatter(x[:,<span class="dv">0</span>], x[:,<span class="dv">1</span>], y, color<span class="op">=</span><span class="st">'purple'</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># when directly solving the linear equation X.theta = y, this is overdetermined, because there are many more equations than variables, so I'm just using the first #dim equations</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co"># if we were doing RANSAC, the number of samples each time would also be this if we were going for the naive simple linear model</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>z_gt <span class="op">=</span> np.linalg.solve(x[:dim, :dim],</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                    gt[:dim])</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'z_gt='</span>, z_gt)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.linalg.solve(x.T.dot(x),</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>                    x.T.dot(y))</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'z='</span>, z)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="co"># plot estimated surface</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co"># z_hat_plane = xx*z[0] + yy*z[1]</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.plot_surface(xx, yy, z_hat_plane, alpha=0.8)</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co"># compute sum of squared error with z model</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>y_hat <span class="op">=</span> x.dot(z)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _y, _yhat <span class="kw">in</span> <span class="bu">zip</span>(y, y_hat):</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(_y, _yhat, (_y <span class="op">-</span> _yhat)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>sse <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y_hat)<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'sse='</span>, sse)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>z_gt= [2. 3.]
z= [2.36005339 3.45161017]
498.05149115937206 574.5597469393441 5853.513202493626
416.08424624646085 481.15941474852406 4234.777555571919
818.027284337562 947.7447939819629 16826.63230834522
698.002393225462 809.5034473039241 12432.485060608122
1265.838120241473 634.6526385678269 398395.11227559263
434.0514600566971 503.2845944966303 4793.22690437786
385.0667088491666 446.08257578312896 3722.9360177029994
539.0813217458266 624.4448301602582 7286.928568820741
551.0355297084866 644.9749847756516 8824.621218315911
898.0262993299492 1044.6240875088097 21490.91149893404
282.0101182399276 326.04381463142465 1938.9664178985424
427.0883939102308 498.4747345033687 5096.009623279489
684.0967788926856 798.2912687546486 13040.381514833973
505.41547356566144 302.9142647416117 41006.7395752014
765.9566503865801 502.92814824605796 69183.99293828667
1097.6825668209226 550.7198711183471 299168.1904902282
542.067331185198 629.1350192133422 7580.782298566241
655.0883434036994 760.0893481338383 11025.210994338651
330.0420294998768 387.46247177722057 3297.1071913257706
575.0687454307048 663.7408741279087 7862.746407693492
320.03943256368274 370.88482911864344 2585.2543508312096
652.5312906551276 730.7045017932729 6111.0509396490515
607.0933046421186 702.3864276344641 9080.779289634287
569.0728431520196 658.6070521890799 8016.374587892019
928.3311122463144 389.7054208010677 290117.6354848701
1237.9963179779847 738.6420100119108 249354.72488427666
656.4260998437064 701.67610170328 2047.5626682914105
1215.611581019908 502.92814824605796 507917.6753503189
602.8457329262199 379.2907548181489 49976.82823690008
775.0847420681971 900.4539728955465 15717.44403824121
162.09472418073915 188.51022731460904 697.77880581549
533.0926000094306 618.7801887005122 7342.362855691976
638.0698781337688 743.1253414896444 11036.650380917707
669.0885866685963 781.033217899932 12531.600461519722
1410.4397929241572 750.9457453380652 434932.39880148665
711.0435327638444 822.2781666809069 12373.143782662917
413.00938834858187 484.0776388285892 5050.696226289065
421.09113196831066 488.03271735536623 4481.175854132452
559.0359950894308 644.8604469753955 7365.836541526263
694.0216110832374 806.198859238242 12583.735003629477
449.0897556349855 517.0038485452311 4612.324015821469
534.0881353749048 623.587482123813 8010.133068481291
875.195470113876 481.8073386396584 154754.22198477635
20.03912089980787 23.069714419724093 9.184497082958206
248.04186343282262 289.1078240578384 1686.413122055346
384.0409862565493 452.7763719797046 4724.553250510946
399.02178012803734 470.0344228344212 5042.795424144534
781.0296173897173 910.01129084202 16636.27208655646
616.6256004240936 186.47413586611202 185030.28246137648
792.0091234242344 919.1873779427983 16174.30842238862
168.0577557136409 196.82896637894203 827.782563147138
702.0524422266658 815.4621329741929 12861.757955449726
965.0855221929623 1121.8280078867479 24568.206821466556
301.0489885012657 349.79137067732745 2375.8198201972637
494.0748875457757 580.1021508889517 7400.690038316144
1111.4084501603766 659.3720804504312 204336.8795405464
447.007134960422 514.9976748317786 4622.71351199853
202.0198919753634 234.826595994363 1076.2798285902443
387.0117187894418 446.49629093382947 3538.414323200865
625.0884859805207 721.6805699376777 9330.030683186467
315.0028562474588 369.67360140158655 2988.8903757075836
721.0017127690058 835.8478320542856 13189.631114888709
322.0029696367921 377.8453183606581 3118.3679109978584
1012.0710946131396 228.4841129084382 614008.557897084
647.0732523568516 754.3648712040033 11511.491474842467
346.0627427011371 406.16595908942793 3612.3966202177116
1106.6549820079704 209.45666365066364 804964.8224631792
107.01486125724051 124.40498825922106 302.41651714501285
592.0374982598751 688.3132939052516 9269.028827150305
927.2070217575082 924.6451618271942 6.563126302548308
495.0902673546589 575.1777530954339 6414.005372278836
645.0850063420996 745.9888632395423 10181.588336779589
832.0517682752575 584.146982620862 61456.78275035177
306.06772073335054 352.4181171168307 2148.3592449057282
343.0164483711958 395.4598154659472 2750.3067522348547
462.92919346544784 279.0769554905756 33801.64540836906
227.06167667958067 265.6543122224583 1489.3915181453829
180.07708873208742 211.69704610455005 999.8217042363542
362.09075713817236 422.56922847766 3657.6454955612244
659.066074959323 764.4555752413551 11106.94676969643
1033.7456260172646 652.5885310487222 145280.73104485846
700.0779601990458 815.5792373444096 13340.54502221014
574.4739040734737 465.7605155019986 11818.600854692531
539.0020020412672 623.7370707990351 7180.031877383647
153.07627113256407 179.92479520483698 720.8432448594178
360.0165603279691 421.9785734866538 3839.291074677012
563.0449345025556 655.9503880145323 8631.423292266065
258.04171089337035 298.2539934235723 1617.0276662887848
935.0793269846837 1087.1349663370088 23120.917458844357
1286.845352355487 919.9549727741103 134608.55062936668
452.09054582717926 525.0558945641251 5323.9421163041225
436.09165108221805 504.7599486891655 4715.335096236308
536.017953286522 624.5320167954308 7834.739438859131
302.09362483665046 356.0141828230746 2907.4265735673252
494.0595550927943 577.0941736037532 6894.747871260482
621.0166803935545 723.1533575602521 10431.900822654208
640.0761291095449 743.0082371194275 10595.018859358126
187.06964647436743 216.15302641720007 845.8429888991596
460.02314115285435 535.7346870225222 5732.238177974814
504.06637686948324 590.6638389771318 7499.1204434856345
sse= 2295.6301919648135</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="l2_files/figure-html/cell-2-output-2.png" width="414" height="396"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>